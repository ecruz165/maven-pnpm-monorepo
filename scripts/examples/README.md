# Example Outputs

This directory contains example outputs from the monorepo build scripts, demonstrating what to expect when running various commands.

## Change Detection Artifacts

The `artifacts/` directory shows example output from the `changed-modules.js` script when **no modules have changed**. This represents a typical scenario where CI/CD detects no work needs to be done.

### Files Generated by `changed-modules.js --output .artifacts`

| File | Description | Example Content |
|------|-------------|-----------------|
| **change-detection.json** | Structured JSON with all detection results | Base branch, all modules, changed files, changed modules |
| **summary.txt** | Human-readable summary | Statistics and list of changed modules |
| **changed-files.txt** | Line-delimited list of changed file paths | One file path per line (empty if no changes) |
| **changed-modules.txt** | Line-delimited list of changed module names | One module name per line (empty if no changes) |
| **maven-pl.txt** | Maven `-pl` argument for changed modules | Comma-separated module paths (empty if no changes) |

### Understanding the Examples

The example files in `artifacts/` show a **clean state** where:
- No files have changed since the base branch (main)
- All 3 demo modules are detected but unchanged
- All output files except `change-detection.json` and `summary.txt` are empty
- This is what CI/CD sees when no builds are needed

### Typical Workflow Output

When modules **have changed**, the output would look like:

**changed-files.txt:**
```
demo-module-a/src/main/java/com/example/App.java
demo-module-a/pom.xml
```

**changed-modules.txt:**
```
demo-module-a
```

**maven-pl.txt:**
```
demo-module-a
```

**summary.txt:**
```
Change Detection Summary
========================

Base Branch: main
Total Modules: 3
Changed Modules: 1

Changed Files: 2
  - demo-module-a/src/main/java/com/example/App.java
  - demo-module-a/pom.xml

Modules with Changes:
  - demo-module-a

All Modules:
  - demo-module-a
  - demo-module-b
  - demo-module-c
```

## Usage in CI/CD

These artifacts are used by:

1. **GitHub Actions** (`.github/workflows/version-and-publish.yml`)
   - Reads `.artifacts/maven-pl.txt` to determine which modules to build
   - Uses `.artifacts/summary.txt` for logging and job summaries

2. **AWS CodeBuild** (`.aws/buildspec.yml`)
   - Reads `.artifacts/maven-pl.txt` into `$CHANGED_MODULES` environment variable
   - Skips build if no modules changed (early exit optimization)

3. **Parallel Build Script** (`scripts/src/parallel-build.js`)
   - Takes module list from `maven-pl.txt` or command-line arguments
   - Builds only specified modules in parallel

## Regenerating Examples

To regenerate these example outputs:

```bash
# Run change detection (outputs to .artifacts by default)
node scripts/src/changed-modules.js --output .artifacts

# Copy to examples
cp -r .artifacts/* scripts/examples/artifacts/
```

## Notes

- The `.artifacts/` directory is gitignored to prevent committing actual build artifacts
- These examples are committed to provide documentation and testing references
- Examples represent a "no changes" state to show baseline behavior
